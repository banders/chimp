package ca.bc.gov.catchment.algorithms;

import org.geotools.feature.DefaultFeatureCollection;
import org.junit.Test;
import org.locationtech.jts.geom.Geometry;
import org.locationtech.jts.geom.LineString;
import org.locationtech.jts.geom.Polygon;
import org.locationtech.jts.io.ParseException;

import ca.bc.gov.catchment.synthetic.TestHelper;

public class RidgeCleanerTest {

	@Test
	public void testTruncateAtLoopback() throws ParseException {
		LineString ridge = (LineString)TestHelper.geometryFromWkt("LineStringZ (1672139.89999999990686774 502253 840.04180908203125, 1672133.5 502216.29999999998835847 848.2491455078125, 1672127.5 502193.90000000002328306 850.8248291015625, 1672164.89999999990686774 502132 904.79815673828125, 1672173.19999999995343387 502120.79999999998835847 910.73468017578125, 1672186.10000000009313226 502107.40000000002328306 936.79693603515625, 1672230.69999999995343387 502076.40000000002328306 960.65545654296875, 1672258.5 502055 972.8297119140625, 1672311.60000000009313226 502011.20000000001164153 1000.32818603515625, 1672336 501986.20000000001164153 1051.520263671875, 1672363 501940.5 1085.855224609375, 1672379.5 501903.90000000002328306 1092.482177734375, 1672392.80000000004656613 501880.90000000002328306 1095.8037109375, 1672428.55000000004656613 501835.5 1161.100341796875, 1672464.30000000004656613 501790.09999999997671694 1179.8226318359375, 1672510.69999999995343387 501736.20000000001164153 1260.1417236328125, 1672512.00051557761617005 501736.59369316883385181 1260.1064453125, 1672537.30000000004656613 501698.5 1267.3883056640625, 1672564.39999999990686774 501667.29999999998835847 1291.483154296875, 1672582.30000000004656613 501649.59999999997671694 1310.405029296875, 1672610.05000000004656613 501613.19999999995343387 1335.3875732421875, 1672637.80000000004656613 501576.79999999998835847 1368.6376953125, 1672680 501535.09999999997671694 1401.2891845703125, 1672713.87240353878587484 501500.50405126251280308 1446.3819580078125, 1672752.39999999990686774 501477.79999999998835847 1462.6573486328125, 1672771.80000000004656613 501465 1475.0137939453125, 1672790.5 501455.29999999998835847 1487.9652099609375, 1672805 501450.40000000002328306 1489.823974609375, 1672838.5 501440.5 1514.138916015625, 1672901.10000000009313226 501430.90000000002328306 1565.158447265625, 1672963.69999999995343387 501421.29999999998835847 1595.2315673828125, 1673026.29999999981373549 501411.69999999995343387 1594.332763671875, 1673088.89999999990686774 501402.09999999997671694 1592.7291259765625, 1673127.54999999981373549 501373.29999999998835847 1597.1907958984375, 1673166.19999999995343387 501344.5 1605.2640380859375, 1673160.66554225678555667 501322.98022658377885818 1605, 1673153.33333333325572312 501280.5 1606.150146484375, 1673171.68525706115178764 501244.80249218549579382 1609, 1673174.22356651676818728 501224.97846784722059965 1613.0211181640625, 1673182.57805059850215912 501167.61603474523872137 1620, 1673181.19999999995343387 501109.76666666666278616 1643.242431640625, 1673191.25215878803282976 501084.10082564875483513 1643, 1673234.80000000004656613 501067.03333333332557231 1643.7276611328125, 1673259.12235459592193365 501066.59832588955760002 1638, 1673288.39999999990686774 501024.29999999998835847 1628.764404296875, 1673333.59225307870656252 500997.55359260272234678 1626.287353515625, 1673347.60000000009313226 500986.5 1614.524169921875, 1673388.5 500965.59999999997671694 1602.2042236328125, 1673437.39999999990686774 500950.09999999997671694 1558.0457763671875, 1673501.10000000009313226 500932.40000000002328306 1523.7626953125, 1673539.25 500924.70000000001164153 1497.67724609375, 1673577.39999999990686774 500917 1476.9688720703125, 1673583.10000000009313226 500911.90000000002328306 1474.677734375, 1673625.45000000018626451 500868.65000000002328306 1444.0931396484375, 1673667.80000000004656613 500825.40000000002328306 1418.690185546875, 1673692.10000000009313226 500812.29999999998835847 1407.3709716796875, 1673752.19999999995343387 500812.59999999997671694 1386.6077880859375, 1673787.80000000004656613 500830.40000000002328306 1367.223388671875, 1673787.28202346782200038 500797.7465738644823432 1366, 1673789.89999999990686774 500767.90000000002328306 1367.851806640625, 1673860.05360563634894788 500805.0511281993240118 1334, 1673835.80000000004656613 500717.5 1327.6658935546875, 1673854.89999999990686774 500692.29999999998835847 1310.351806640625, 1673889.14999999990686774 500663.09999999997671694 1290.9710693359375, 1673896.76319854985922575 500644.53104124870151281 1279, 1673823.5057637277059257 500633.13445767387747765 1319, 1673803.14226908795535564 500721.19680069386959076 1349, 1673723.15810377174057066 500762.3335535628721118 1398, 1673699.80000000004656613 500709.5 1397.571044921875, 1673702.30000000004656613 500694.20000000001164153 1391.051025390625, 1673739.6309182089753449 500688.88458575587719679 1373, 1673720.89999999990686774 500628.09999999997671694 1363.7125244140625, 1673757.60481708729639649 500611.59814009442925453 1341, 1673740.30000000004656613 500575.59999999997671694 1343.67626953125, 1673686.75396430306136608 500628.71836694236844778 1378, 1673668.04057441186159849 500703.89525348879396915 1415, 1673619.68875990062952042 500624.15964996907860041 1416, 1673604.69517345819622278 500701.8278074599802494 1432, 1673554.5664435881190002 500635.96893460582941771 1434, 1673539.19216110371053219 500716.61070706509053707 1452, 1673591.18070019222795963 500783.71525125578045845 1438, 1673653.89143863879144192 500790.73864901904016733 1419, 1673695.95000000018626451 500760.90000000002328306 1407.3955078125)");
				
		RidgeCleaner.truncateAtLoopback(ridge);
	}
	
	@Test
	public void dummtTest() throws ParseException {
		Polygon p1 = (Polygon)TestHelper.geometryFromWkt("Polygon ((3 3, 3 5, 5 5, 5 3, 3 3))");
		Polygon p2 = (Polygon)TestHelper.geometryFromWkt("Polygon ((2 2, 2 4, 4 4, 4 2, 2 2))");
		Polygon p3 = (Polygon)TestHelper.geometryFromWkt("Polygon ((2 3, 3 3, 3 5, 2 5, 2 3))");
		Geometry u1 = p1.union(p2);
		//Geometry u2 = p1.union(p3);
		System.out.println(u1);
		//System.out.println(u2);		
	}
}
